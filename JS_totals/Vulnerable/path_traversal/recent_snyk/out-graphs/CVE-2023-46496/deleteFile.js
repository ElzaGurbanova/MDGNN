const v31 = require('path');
const join = v31.join;
const v32 = require('fs');
const existsSync = v32.existsSync;
const unlinkSync = v32.unlinkSync;
const lstatSync = v32.lstatSync;
const v33 = require('@evershop/evershop/src/lib/helpers');
const CONSTANTS = v33.CONSTANTS;
const v34 = require('@evershop/evershop/src/lib/util/httpStatus');
const INVALID_PAYLOAD = v34.INVALID_PAYLOAD;
const OK = v34.OK;
const v60 = (request, response, delegate, next) => {
    const v35 = request.params;
    const v36 = v35[0];
    const path = v36 || '';
    const v37 = CONSTANTS.MEDIAPATH;
    const v38 = join(v37, path);
    const v39 = existsSync(v38);
    const v40 = !v39;
    if (v40) {
        const v41 = response.status(INVALID_PAYLOAD);
        const v42 = {};
        v42.status = INVALID_PAYLOAD;
        v42.message = 'Requested path does not exist';
        const v43 = { error: v42 };
        const v44 = v41.json(v43);
        v44;
    } else {
        const v45 = CONSTANTS.MEDIAPATH;
        const v46 = join(v45, path);
        const v47 = lstatSync(v46);
        const v48 = v47.isDirectory();
        if (v48) {
            const v49 = response.status(INVALID_PAYLOAD);
            const v50 = {};
            v50.status = INVALID_PAYLOAD;
            v50.message = 'Requested path is not a file';
            const v51 = { error: v50 };
            const v52 = v49.json(v51);
            v52;
        } else {
            const v53 = CONSTANTS.MEDIAPATH;
            const v54 = join(v53, path);
            const v55 = unlinkSync(v54);
            v55;
            const v56 = response.status(OK);
            const v57 = {};
            v57.path = path;
            const v58 = { data: v57 };
            const v59 = v56.json(v58);
            v59;
        }
    }
};
module.exports = v60;